#!/usr/bin/env php
<?php

declare(strict_types=1);

namespace webignition\BasilRunner\Bin;

const VERSION = 'dev-master';

use Symfony\Component\Console\Output\StreamOutput;
use webignition\BasilRunner\Command\RunCommand;
use webignition\BasilRunner\Model\RunnerClientConfiguration;
use webignition\BasilRunner\Services\RunnerClientFactory;
use webignition\BasilRunner\Services\SuiteManifestFactory;
use webignition\SingleCommandApplicationFactory\Factory;

require dirname(__DIR__) . '/vendor/autoload.php';

$output = new StreamOutput(STDOUT);

$runnerClientFactory = new RunnerClientFactory(
    [
        new RunnerClientConfiguration('chrome', 'chrome-runner', 9000),
        new RunnerClientConfiguration('firefox', 'firefox-runner', 9001)
    ],
    $output
);

$application = (new Factory())->create(
    new RunCommand($runnerClientFactory, SuiteManifestFactory::createFactory()),
    VERSION
);

$application->run(null, $output);
