#!/usr/bin/env php
<?php

declare(strict_types=1);

namespace webignition\BasilRunner\Bin;

use Symfony\Component\Console\Application;
use webignition\BasilRunner\ApplicationConfiguration;
use webignition\BasilRunner\Command\RunCommand;
use webignition\BasilRunner\Kernel;

require dirname(__DIR__) . '/config/bootstrap.php';

$kernel = new Kernel($_SERVER['APP_ENV'], true);
$kernel->boot();

$container = $kernel->getContainer();

/* @var Application $application */
$application = $container->get(Application::class);

/* @var ApplicationConfiguration $applicationConfiguration */
$applicationConfiguration = $container->get(ApplicationConfiguration::class);
$applicationConfiguration->configureApplication($application);

/* @var RunCommand $runCommand */
$runCommand = $container->get(RunCommand::class);
$application->setDefaultCommand($runCommand->getName());

$application->run();
